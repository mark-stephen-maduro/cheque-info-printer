<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Cheque Printing App with Live Calibration</title>
    <style>
      body {
        font-family: "Segoe UI", Arial, sans-serif;
        background: #f4f6fa;
        margin: 0;
        padding: 0;
      }

      .main-container {
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: flex-start;
        width: 100vw;
        max-width: 100vw;
        margin: 0 auto;
        gap: 0;
      }
      .author-ui {
        display: flex;
        justify-content: center;
        align-items: center;
        width: 100%;
        margin-top: 18px;
        margin-bottom: 0;
      }
      .author-ui-box {
        font-size: 1rem;
        color: #555;
        padding: 6px 18px;
        border-radius: 8px;
        font-family: inherit;
      }
      .author-ui-box strong {
        color: #1976d2;
      }
      .header-wrapper {
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        width: 100%;
        margin-bottom: 0;
      }
      h2 {
        margin-top: 0;
        margin-bottom: 24px;
        font-weight: 600;
        color: #222;
        letter-spacing: 1px;
      }
      #toggleGuidelines {
        width: 100%;
        text-align: center;
        padding: 8px 0;
        font-size: 1.08rem;
        color: #1976d2;
        background: none;
        border: none;
        cursor: pointer;
        font-weight: 500;
      }
      .guidelines {
        width: 100%;
        max-width: 650px;
        margin: 0 auto 0 auto;
        box-sizing: border-box;
      }
      .guidelines h3 {
        margin: 12px 0 8px 0;
        font-size: 1.08rem;
        color: #1976d2;
        font-weight: 500;
      }
      .guidelines ul {
        margin: 0 0 18px 0;
        padding-left: 18px;
        font-size: 0.98rem;
        color: #444;
      }
      form#chequeForm {
        background: none;
        border: none;
        box-shadow: none;
        padding: 0;
        display: flex;
        flex-direction: column;
        align-items: flex-start;
        gap: 0;
        min-width: 340px;
        max-width: 650px;
        margin-bottom: 36px;
        width: 100%;
      }
      .form-row {
        display: flex;
        flex-direction: row;
        gap: 18px;
        width: 100%;
        margin-bottom: 12px;
      }
      form#chequeForm label {
        display: flex;
        flex-direction: column;
        font-size: 1rem;
        color: #333;
        width: 100%;
        margin: 0;
        gap: 6px;
      }
      form#chequeForm input,
      form#chequeForm select {
        font-size: 1rem;
        padding: 8px 10px;
        border: 1px solid #cfd8dc;
        border-radius: 6px;
        background: #f9fafb;
        margin-top: 2px;
        margin-bottom: 0;
        outline: none;
        transition: border 0.2s;
      }
      form#chequeForm input:focus,
      form#chequeForm select:focus {
        border: 1.5px solid #1976d2;
        background: #fff;
      }
      .form-actions {
        display: flex;
        flex-direction: row;
        gap: 12px;
        margin-top: 0;
        margin-bottom: 0;
        align-items: flex-start;
        justify-content: flex-start;
      }
      form#chequeForm button {
        font-size: 1rem;
        padding: 10px 22px;
        border: none;
        border-radius: 6px;
        background: #1976d2;
        color: #fff;
        font-weight: 500;
        margin: 0;
        cursor: pointer;
        box-shadow: none;
        transition: background 0.2s;
      }
      form#chequeForm button[type="button"] {
        background: #455a64;
      }
      form#chequeForm button:hover {
        background: #1565c0;
      }
      form#chequeForm button[type="button"]:hover {
        background: #263238;
      }
      #customSizeInputs {
        display: flex;
        gap: 12px;
        width: 100%;
        margin-top: 0;
        margin-bottom: 15px;
      }
      #preview {
        margin-top: 36px;
        border: 2.5px solid #3e2723;
        background: repeating-linear-gradient(
          135deg,
          #f7f3e9 0 8px,
          #f4e7c5 8px 16px
        );
        border-radius: 8px;
        position: relative;
        overflow: hidden;
        box-shadow: 0 2px 16px rgba(62, 39, 35, 0.13);
        display: flex;
        align-items: center;
        justify-content: center;
        min-width: 340px;
        min-height: 120px;
        max-width: 100vw;
      }

      .cheque-decor {
        position: absolute;
        left: 0;
        top: 0;
        right: 0;
        bottom: 0;
        pointer-events: none;
        z-index: 0;
      }

      .cheque-header {
        position: absolute;
        left: 24px;
        top: 12px;
        font-size: 1.05rem;
        font-weight: 600;
        color: #3e2723;
        letter-spacing: 1.5px;
        opacity: 0.85;
        z-index: 1;
        font-family: "Segoe UI", Arial, sans-serif;
      }
      .cheque-footer {
        position: absolute;
        right: 24px;
        bottom: 10px;
        font-size: 0.95rem;
        color: #6d4c41;
        opacity: 0.7;
        z-index: 1;
        font-family: "Segoe UI", Arial, sans-serif;
      }
      .cheque-field {
        position: absolute;
        font-size: 1.1rem;
        cursor: move;
        background: rgba(255, 255, 255, 0.85);
        padding: 2px 7px;
        border: 1px dashed #90a4ae;
        border-radius: 4px;
        box-shadow: 0 1px 4px rgba(0, 0, 0, 0.04);
        color: #263238;
        user-select: none;
        transition: box-shadow 0.2s;
      }
      .cheque-field:active {
        box-shadow: 0 2px 8px rgba(25, 118, 210, 0.12);
      }
      #calibration-controls {
        margin-top: 20px;
      }
      @media print {
        body * {
          visibility: hidden;
        }
        #preview,
        #preview * {
          visibility: visible;
        }
        #preview {
          position: absolute;
          left: 0;
          top: 0;
          border: none !important;
          box-shadow: none !important;
        }
        .cheque-field {
          border: none !important;
          box-shadow: none !important;
          background: #fff !important;
        }
        .cheque-header,
        .cheque-footer {
          display: none !important;
        }
      }

      @media (min-width: 900px) {
        .main-container {
          flex-direction: column;
          align-items: center;
          justify-content: center;
          gap: 48px;
          margin-top: 40px;
        }
        form#chequeForm {
          margin-top: 0;
          margin-bottom: 0;
        }
        #preview {
          margin-top: 0;
        }
      }

      @media (max-width: 899px) {
        #preview {
          overflow-x: auto;
          overflow-y: visible;
          max-width: 100vw;
          min-width: unset;
          min-height: 120px;
          border-radius: 8px;
          box-sizing: border-box;
        }
      }

      /* Default cheque size for printing (8" x 3.5") */
      @page {
        size: 215mm 89mm;
        margin: 0;
      }
    </style>
  </head>

  <body>
    <div class="main-container">
      <div class="header-wrapper">
        <div class="author-ui">
          <div class="author-ui-box">
            <strong>Mark Stephen</strong>
          </div>
        </div>
        <h2>Cheque Form Printing</h2>
        <div class="guidelines">
          <button id="toggleGuidelines">â–¶ Printer Alignment Guidelines</button>
          <div id="guidelinesContent" style="display: none">
            <ul
              style="
                margin: 0 0 18px 0;
                padding-left: 18px;
                font-size: 0.98rem;
                color: #444;
              "
            >
              <li>
                Set your printer paper size to
                <strong>215mm x 89mm</strong> (8.5" x 3.5") for Philippine
                cheques, or match your cheque size.
              </li>
              <li>
                Use the <strong>Print</strong> button in this app for best
                results.
              </li>
              <li>
                Ensure the cheque is loaded straight and aligned to the top-left
                of the printer tray.
              </li>
              <li>
                Disable any printer scaling, fit-to-page, or margins in the
                print dialog.
              </li>
              <li>
                Preview the printout before printing to confirm alignment.
              </li>
              <li>
                If needed, use the calibration controls to adjust field
                positions and save them for future prints.
              </li>
            </ul>
          </div>
        </div>
      </div>

      <form id="chequeForm">
        <div class="form-row">
          <label
            >Font:
            <select id="fontSelect">
              <option value="Calibri, sans-serif" selected>Calibri</option>
              <option value="Arial, sans-serif">Arial</option>
              <option value="Times New Roman, Times, serif">
                Times New Roman
              </option>
              <option value="Courier New, Courier, monospace">
                Courier New
              </option>
              <option value="Tahoma, Geneva, sans-serif">Tahoma</option>
              <option value="Verdana, Geneva, sans-serif">Verdana</option>
              <option value="Georgia, serif">Georgia</option>
              <option value="System-ui, sans-serif">System UI</option>
            </select>
          </label>
          <label>Payee Name: <input type="text" id="payee" required /></label>
        </div>
        <div class="form-row">
          <label>Date: <input type="date" id="date" required /></label>
          <label
            >Amount: <input type="number" id="amount" step="0.01" required
          /></label>
          <label
            >Cheque Size:
            <select id="sizeSelect">
              <option value="215x89">8.5" Ã— 3.5" (Philippines)</option>
              <option value="152x70">6" Ã— 2.75" (US/Canada)</option>
              <option value="custom">Custom</option>
            </select>
          </label>
        </div>
        <div id="customSizeInputs" style="display: none">
          <label
            >Width (mm):
            <input type="number" id="customWidth" min="100" max="300"
          /></label>
          <label
            >Height (mm):
            <input type="number" id="customHeight" min="50" max="150"
          /></label>
        </div>
        <div class="form-actions">
          <button type="submit">Generate Preview</button>
          <button type="button" onclick="window.print()">Print</button>
        </div>
      </form>
      <div id="preview">
        <div class="cheque-decor"></div>
        <div class="cheque-header">BANK OF EXAMPLE</div>
        <div class="cheque-footer">Authorized Signature</div>
      </div>
    </div>

    <script>
      // Collapsible guidelines logic
      const toggleBtn = document.getElementById("toggleGuidelines");
      const guidelinesContent = document.getElementById("guidelinesContent");
      toggleBtn.addEventListener("click", function () {
        const isCollapsed = guidelinesContent.style.display === "none";
        guidelinesContent.style.display = isCollapsed ? "block" : "none";
        toggleBtn.textContent =
          (isCollapsed ? "â–¼" : "â–¶") + " Printer Alignment Guidelines";
      });
      // Set initial collapsed state
      guidelinesContent.style.display = "none";
      toggleBtn.textContent = "â–¶ Printer Alignment Guidelines";
      const form = document.getElementById("chequeForm");
      const preview = document.getElementById("preview");
      const fontSelect = document.getElementById("fontSelect");
      const sizeSelect = document.getElementById("sizeSelect");
      const customSizeInputs = document.getElementById("customSizeInputs");

      sizeSelect.addEventListener("change", () => {
        customSizeInputs.style.display =
          sizeSelect.value === "custom" ? "flex" : "none";
      });

      const fields = [
        { label: "Payee", id: "payee", defaultX: 10, defaultY: 10 },
        { label: "Date", id: "date", defaultX: 160, defaultY: 10 },
        { label: "AmountNumber", id: "amount", defaultX: 160, defaultY: 40 },
        { label: "AmountWords", id: "words", defaultX: 10, defaultY: 60 },
      ];

      form.addEventListener("submit", (e) => {
        e.preventDefault();

        const payee = document.getElementById("payee").value;
        const date = document.getElementById("date").value;
        const amount = parseFloat(
          document.getElementById("amount").value
        ).toFixed(2);

        let width, height;
        if (sizeSelect.value === "custom") {
          width = parseFloat(
            document.getElementById("customWidth").value || 200
          );
          height = parseFloat(
            document.getElementById("customHeight").value || 80
          );
        } else {
          [width, height] = sizeSelect.value.split("x").map(Number);
        }

        // Format amount with commas
        const formattedAmount = Number(amount).toLocaleString("en-US", {
          minimumFractionDigits: 2,
          maximumFractionDigits: 2,
        });

        // Format date as mm-dd-yyyy
        let formattedDate = date;
        if (date) {
          const d = new Date(date);
          const mm = String(d.getMonth() + 1).padStart(2, "0");
          const dd = String(d.getDate()).padStart(2, "0");
          const yyyy = d.getFullYear();
          formattedDate = `${mm}-${dd}-${yyyy}`;
        }

        // Determine if there are centavos
        const [whole, cents] = amount.split(".");
        const amountWords = numToWords(amount);
        let wordsSuffix = "";
        if (parseInt(cents) > 0) {
          wordsSuffix = " Only";
        } else {
          wordsSuffix = " Pesos Only";
        }

        // Remove all cheque fields but keep decor/header/footer
        Array.from(preview.querySelectorAll(".cheque-field")).forEach((el) =>
          el.remove()
        );
        preview.style.width = width + "mm";
        preview.style.height = height + "mm";
        // Set font family for preview
        preview.style.fontFamily = fontSelect.value;

        fields.forEach((f) => {
          let value = "";
          if (f.id === "payee") value = payee;
          else if (f.id === "date") value = formattedDate;
          else if (f.id === "amount") value = formattedAmount;
          else if (f.id === "words") value = amountWords + wordsSuffix;

          const div = document.createElement("div");
          div.className = "cheque-field";
          div.textContent = value;
          div.style.left =
            (localStorage.getItem(f.id + "_x") || f.defaultX) + "mm";
          div.style.top =
            (localStorage.getItem(f.id + "_y") || f.defaultY) + "mm";
          div.setAttribute("data-id", f.id);
          // Set font family for each field
          div.style.fontFamily = fontSelect.value;

          makeDraggable(div);
          preview.appendChild(div);
        });
      });

      function makeDraggable(el) {
        let isDragging = false,
          startX,
          startY;
        el.addEventListener("mousedown", (e) => {
          isDragging = true;
          startX = e.clientX;
          startY = e.clientY;
          document.onmousemove = (e) => {
            if (!isDragging) return;
            const dx = e.clientX - startX;
            const dy = e.clientY - startY;
            const left = parseFloat(el.style.left) + dx * 0.2646;
            const top = parseFloat(el.style.top) + dy * 0.2646;
            el.style.left = left + "mm";
            el.style.top = top + "mm";
            localStorage.setItem(el.getAttribute("data-id") + "_x", left);
            localStorage.setItem(el.getAttribute("data-id") + "_y", top);
            startX = e.clientX;
            startY = e.clientY;
          };
          document.onmouseup = () => {
            isDragging = false;
            document.onmousemove = null;
          };
        });
      }

      function numToWords(amount) {
        const th = ["", "Thousand", "Million", "Billion"];
        const dg = [
          "Zero",
          "One",
          "Two",
          "Three",
          "Four",
          "Five",
          "Six",
          "Seven",
          "Eight",
          "Nine",
        ];
        const tn = [
          "Ten",
          "Eleven",
          "Twelve",
          "Thirteen",
          "Fourteen",
          "Fifteen",
          "Sixteen",
          "Seventeen",
          "Eighteen",
          "Nineteen",
        ];
        const tw = [
          "Twenty",
          "Thirty",
          "Forty",
          "Fifty",
          "Sixty",
          "Seventy",
          "Eighty",
          "Ninety",
        ];

        function toWords(s) {
          s = parseInt(s);
          if (s === 0) return "Zero";
          let str = "",
            i = 0;
          while (s > 0) {
            let rem = s % 1000;
            if (rem !== 0) {
              let segment = "";
              let hundreds = Math.floor(rem / 100);
              let tens = rem % 100;
              if (hundreds) segment += dg[hundreds] + " Hundred ";
              if (tens < 20 && tens >= 10) segment += tn[tens - 10] + " ";
              else {
                let t = Math.floor(tens / 10);
                let u = tens % 10;
                if (t) segment += tw[t - 2] + " ";
                if (u) segment += dg[u] + " ";
              }
              str = segment + th[i] + " " + str;
            }
            s = Math.floor(s / 1000);
            i++;
          }
          return str.trim();
        }

        const [whole, cents] = amount.split(".");
        let words = toWords(whole);
        if (parseInt(cents) > 0) {
          words += " and " + toWords(cents) + " Centavos";
        }
        return words;
      }
    </script>
  </body>
</html>
